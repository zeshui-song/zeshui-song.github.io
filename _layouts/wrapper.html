<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />

    <link rel="stylesheet" href="/css/styles.css">
    <link rel="stylesheet" href="/css/syntax.css">

    <script src="{{ '/assets/js/script.js' | relative_url }}"></script>
    
    <!-- MathJax (LaTeX support) -->
    <script>
      MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']],
          displayMath: [['$$', '$$'], ['\\[', '\\]']]
        }
      };
    </script>
    <script
      src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"
      async>
    </script>
    <!-- End MathJax -->

<!-- PREVIEW METADATA -->
<meta property="og:type" content="website">
<meta property="og:url" content="{{ site.url }}{{ page.url }}">
<meta property="og:title" content="{{ page.title | default: site.title }}">

{% assign og_description = page.description | default: site.description | strip_html | truncate: 200 %}
<meta property="og:description" content="{{ og_description }}">

{% if page.main-image %}
  {% comment %} 
    1. Reconstruct the directory path from the page.path 
    2. This handles nested folders correctly (e.g., /projects/my-work/)
  {% endcomment %}
  {% assign path_parts = page.path | split: "/" %}
  {% assign dir_path = "" %}
  {% for part in path_parts %}
    {% unless forloop.last %}
      {% assign dir_path = dir_path | append: "/" | append: part %}
    {% endunless %}
  {% endfor %}

  {% comment %} 
    3. Build the absolute GitHub Raw URL and escape it for spaces/special chars
  {% endcomment %}
  {% assign image_url = "https://raw.githubusercontent.com/zeshui-song/zeshui-song.github.io/refs/heads/main" | append: dir_path | append: "/" | append: page.main-image | uri_escape %}

  <meta property="og:image" content="{{ image_url }}">
  <meta name="twitter:image" content="{{ image_url }}">
{% else %}
  {% comment %} Fallback for pages without a main-image {% endcomment %}
  <meta property="og:image" content="{{ site.url }}/assets/images/homepage-preview.png">
  <meta name="twitter:image" content="{{ site.url }}/assets/images/homepage-preview.png">
{% endif %}

<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="{{ page.title | default: site.title }}">
<meta name="twitter:description" content="{{ og_description }}">
<meta name="twitter:image:aspect_ratio" content="1.91:1">
<!-- END PREVIEW METADATA -->
    
    <title>{{ site.title }}</title>
</head>
<body>
    <!-- NAVBAR -->
     {% include navbar.html%}

     <div class="page">{{content}}</div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-c.min.js"></script>
    
</body>

    {% include footer.html%}
</html>